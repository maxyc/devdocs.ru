---
layout: post
status: publish
published: true
title: Как сделать скриншот сайта на PHP?
author:
  display_name: Maxyc Webber
  login: admin
  email: maxycws@gmail.com
  url: ''
author_login: admin
author_email: maxycws@gmail.com
excerpt: "Сегодня мне понадобилось для наполнения сайта заказчика сделать около 200
  скриншотов разных сайтов. При этом итоговые изображения должны быть определенного
  формата, размера. Решил поделиться с общественностью вариантом решения задачи.\r\n\r\nА
  решение очень простое. У меня лично нет времени изобретать велосипед, поэтому я
  воспользовался API замечательного сервиса для создания скриншотов s-shot.ru.\r\n\r\nAPI
  очень простое. Нужно всего лишь обратиться по специально составленному URL и получить
  свое изображение. Вот примеры с официального сайта:"
wordpress_id: 47945
wordpress_url: http://devdocs.ru/?p=47945
date: '2015-11-05 14:07:20 +0200'
date_gmt: '2015-11-05 14:07:20 +0200'
categories:
- PHP
tags:
- php
- ip
- spl
- javascript
- git
- ui
- api
- screenshot
comments: []
---
<p>Сегодня мне понадобилось для наполнения сайта заказчика сделать около 200 скриншотов разных сайтов. При этом итоговые изображения должны быть определенного формата, размера. Решил поделиться с общественностью вариантом решения задачи.</p>
<p>А решение очень простое. У меня лично нет времени изобретать велосипед, поэтому я воспользовался API замечательного сервиса для создания скриншотов s-shot.ru.</p>
<p>API очень простое. Нужно всего лишь обратиться по специально составленному URL и получить свое изображение. Вот примеры с официального сайта:<a id="more"></a><a id="more-47945"></a></p>
<blockquote><p>Для создания скриншота сайта достаточно одного параметра &ndash; его адреса.</p>
<p>http:&#47;&#47;mini.s-shot.ru&#47;?адрес страницы</p>
<p>пример:</p>
<p>http:&#47;&#47;mini.s-shot.ru&#47;?http:&#47;&#47;www.site.ru</p>
<p>Дополнительные параметры:</p>
<p>разрешение - указывается в пикселях, например (1024&times;768), для полноразмерного скриншота указываем только ширину (1024)</p>
<p>размер - указывается ширина масштабированной картинки</p>
<p>формат - может принимать два значения (JPEG|PNG), по умолчанию &ldquo;JPEG&rdquo;</p>
<p>http:&#47;&#47;mini.s-shot.ru&#47;разрешение&#47;размер&#47;формат&#47;?адрес страницы</p>
<p>пример:</p>
<p>http:&#47;&#47;mini.s-shot.ru&#47;1024x768&#47;400&#47;jpeg&#47;?http:&#47;&#47;www.site.ru</p>
<p>или</p>
<p>http:&#47;&#47;mini.s-shot.ru&#47;1024&#47;400&#47;png&#47;?http:&#47;&#47;www.site.ru<&#47;blockquote><br />
Но если все же требуется создание своей скриншотилки, существует удобная библиотека <a href="https:&#47;&#47;github.com&#47;KnpLabs&#47;snappy" target="_blank">https:&#47;&#47;github.com&#47;KnpLabs&#47;snappy<&#47;a></p>
<div class="highlight highlight-text-html-php">
<pre><span class="pl-pse"><?php<&#47;span></p>
<p><span class="pl-s1"><span class="pl-k">require<&#47;span> <span class="pl-c1">__DIR__<&#47;span> <span class="pl-k">.<&#47;span> <span class="pl-s"><span class="pl-pds">'<&#47;span>&#47;vendor&#47;autoload.php<span class="pl-pds">'<&#47;span><&#47;span>;<&#47;span></p>
<p><span class="pl-s1"><span class="pl-k">use<&#47;span> <span class="pl-c1">Knp\Snappy\Pdf<&#47;span>;<&#47;span></p>
<p><span class="pl-s1"><span class="pl-smi">$snappy<&#47;span> <span class="pl-k">=<&#47;span> <span class="pl-k">new<&#47;span> <span class="pl-c1">Pdf<&#47;span>(<span class="pl-s"><span class="pl-pds">'<&#47;span>&#47;usr&#47;local&#47;bin&#47;wkhtmltopdf<span class="pl-pds">'<&#47;span><&#47;span>);<&#47;span></p>
<p><span class="pl-s1"><span class="pl-c">&#47;&#47; or you can do it in two steps<&#47;span><&#47;span><br />
<span class="pl-s1"><span class="pl-smi">$snappy<&#47;span> <span class="pl-k">=<&#47;span> <span class="pl-k">new<&#47;span> <span class="pl-c1">Pdf<&#47;span>();<&#47;span><br />
<span class="pl-s1"><span class="pl-smi">$snappy<&#47;span><span class="pl-k">-><&#47;span>setBinary(<span class="pl-s"><span class="pl-pds">'<&#47;span>&#47;usr&#47;local&#47;bin&#47;wkhtmltopdf<span class="pl-pds">'<&#47;span><&#47;span>);<&#47;span></p>
<p><span class="pl-s1"><span class="pl-c">&#47;&#47; Display the resulting pdf in the browser<&#47;span><&#47;span><br />
<span class="pl-s1"><span class="pl-c">&#47;&#47; by setting the Content-type header to pdf<&#47;span><&#47;span><br />
<span class="pl-s1"><span class="pl-smi">$snappy<&#47;span> <span class="pl-k">=<&#47;span> <span class="pl-k">new<&#47;span> <span class="pl-c1">Pdf<&#47;span>(<span class="pl-s"><span class="pl-pds">'<&#47;span>&#47;usr&#47;local&#47;bin&#47;wkhtmltopdf<span class="pl-pds">'<&#47;span><&#47;span>);<&#47;span><br />
<span class="pl-s1"><span class="pl-c1">header<&#47;span>(<span class="pl-s"><span class="pl-pds">'<&#47;span>Content-Type: application&#47;pdf<span class="pl-pds">'<&#47;span><&#47;span>);<&#47;span><br />
<span class="pl-s1"><span class="pl-c1">header<&#47;span>(<span class="pl-s"><span class="pl-pds">'<&#47;span>Content-Disposition: attachment; filename="file.pdf"<span class="pl-pds">'<&#47;span><&#47;span>);<&#47;span><br />
<span class="pl-s1"><span class="pl-c1">echo<&#47;span> <span class="pl-smi">$snappy<&#47;span><span class="pl-k">-><&#47;span>getOutput(<span class="pl-s"><span class="pl-pds">'<&#47;span>http:&#47;&#47;www.github.com<span class="pl-pds">'<&#47;span><&#47;span>);<&#47;span></p>
<p><span class="pl-s1"><span class="pl-c">&#47;&#47; Merge multiple urls into one pdf<&#47;span><&#47;span><br />
<span class="pl-s1"><span class="pl-c">&#47;&#47; by sending an array of urls to getOutput()<&#47;span><&#47;span><br />
<span class="pl-s1"><span class="pl-smi">$snappy<&#47;span> <span class="pl-k">=<&#47;span> <span class="pl-k">new<&#47;span> <span class="pl-c1">Pdf<&#47;span>(<span class="pl-s"><span class="pl-pds">'<&#47;span>&#47;usr&#47;local&#47;bin&#47;wkhtmltopdf<span class="pl-pds">'<&#47;span><&#47;span>);<&#47;span><br />
<span class="pl-s1"><span class="pl-c1">header<&#47;span>(<span class="pl-s"><span class="pl-pds">'<&#47;span>Content-Type: application&#47;pdf<span class="pl-pds">'<&#47;span><&#47;span>);<&#47;span><br />
<span class="pl-s1"><span class="pl-c1">header<&#47;span>(<span class="pl-s"><span class="pl-pds">'<&#47;span>Content-Disposition: attachment; filename="file.pdf"<span class="pl-pds">'<&#47;span><&#47;span>);<&#47;span><br />
<span class="pl-s1"><span class="pl-c1">echo<&#47;span> <span class="pl-smi">$snappy<&#47;span><span class="pl-k">-><&#47;span>getOutput(<span class="pl-c1">array<&#47;span>(<span class="pl-s"><span class="pl-pds">'<&#47;span>http:&#47;&#47;www.github.com<span class="pl-pds">'<&#47;span><&#47;span>,<span class="pl-s"><span class="pl-pds">'<&#47;span>http:&#47;&#47;www.knplabs.com<span class="pl-pds">'<&#47;span><&#47;span>,<span class="pl-s"><span class="pl-pds">'<&#47;span>http:&#47;&#47;www.php.net<span class="pl-pds">'<&#47;span><&#47;span>));<&#47;span></p>
<p><span class="pl-s1"><span class="pl-c">&#47;&#47; .. or simply save the PDF to a file<&#47;span><&#47;span><br />
<span class="pl-s1"><span class="pl-smi">$snappy<&#47;span> <span class="pl-k">=<&#47;span> <span class="pl-k">new<&#47;span> <span class="pl-c1">Pdf<&#47;span>(<span class="pl-s"><span class="pl-pds">'<&#47;span>&#47;usr&#47;local&#47;bin&#47;wkhtmltopdf<span class="pl-pds">'<&#47;span><&#47;span>);<&#47;span><br />
<span class="pl-s1"><span class="pl-smi">$snappy<&#47;span><span class="pl-k">-><&#47;span>generateFromHtml(<span class="pl-s"><span class="pl-pds">'<&#47;span><br />
<h1>Bill<&#47;h1>
<p>You owe me money, dude.<&#47;p><span class="pl-pds">'<&#47;span><&#47;span>, <span class="pl-s"><span class="pl-pds">'<&#47;span>&#47;tmp&#47;bill-123.pdf<span class="pl-pds">'<&#47;span><&#47;span>);<&#47;span></p>
<p><span class="pl-s1"><span class="pl-c">&#47;&#47; Pass options to snappy<&#47;span><&#47;span><br />
<span class="pl-s1"><span class="pl-c">&#47;&#47; Type wkhtmltopdf -H to see the list of options<&#47;span><&#47;span><br />
<span class="pl-s1"><span class="pl-smi">$snappy<&#47;span> <span class="pl-k">=<&#47;span> <span class="pl-k">new<&#47;span> <span class="pl-c1">Pdf<&#47;span>(<span class="pl-s"><span class="pl-pds">'<&#47;span>&#47;usr&#47;local&#47;bin&#47;wkhtmltopdf<span class="pl-pds">'<&#47;span><&#47;span>);<&#47;span><br />
<span class="pl-s1"><span class="pl-smi">$snappy<&#47;span><span class="pl-k">-><&#47;span>setOption(<span class="pl-s"><span class="pl-pds">'<&#47;span>disable-javascript<span class="pl-pds">'<&#47;span><&#47;span>, <span class="pl-c1">true<&#47;span>);<&#47;span><br />
<span class="pl-s1"><span class="pl-smi">$snappy<&#47;span><span class="pl-k">-><&#47;span>setOption(<span class="pl-s"><span class="pl-pds">'<&#47;span>no-background<span class="pl-pds">'<&#47;span><&#47;span>, <span class="pl-c1">true<&#47;span>);<&#47;span><br />
<span class="pl-s1"><span class="pl-smi">$snappy<&#47;span><span class="pl-k">-><&#47;span>setOption(<span class="pl-s"><span class="pl-pds">'<&#47;span>allow<span class="pl-pds">'<&#47;span><&#47;span>, <span class="pl-c1">array<&#47;span>(<span class="pl-s"><span class="pl-pds">'<&#47;span>&#47;path1<span class="pl-pds">'<&#47;span><&#47;span>, <span class="pl-s"><span class="pl-pds">'<&#47;span>&#47;path2<span class="pl-pds">'<&#47;span><&#47;span>));<&#47;span><br />
<span class="pl-s1"><span class="pl-smi">$snappy<&#47;span><span class="pl-k">-><&#47;span>setOption(<span class="pl-s"><span class="pl-pds">'<&#47;span>cookie<span class="pl-pds">'<&#47;span><&#47;span>, <span class="pl-c1">array<&#47;span>(<span class="pl-s"><span class="pl-pds">'<&#47;span>key<span class="pl-pds">'<&#47;span><&#47;span> <span class="pl-k">=><&#47;span> <span class="pl-s"><span class="pl-pds">'<&#47;span>value<span class="pl-pds">'<&#47;span><&#47;span>, <span class="pl-s"><span class="pl-pds">'<&#47;span>key2<span class="pl-pds">'<&#47;span><&#47;span> <span class="pl-k">=><&#47;span> <span class="pl-s"><span class="pl-pds">'<&#47;span>value2<span class="pl-pds">'<&#47;span><&#47;span>));<&#47;span><br />
<span class="pl-s1"><span class="pl-smi">$snappy<&#47;span><span class="pl-k">-><&#47;span>setOption(<span class="pl-s"><span class="pl-pds">'<&#47;span>cover<span class="pl-pds">'<&#47;span><&#47;span>, <span class="pl-s"><span class="pl-pds">'<&#47;span>pathToCover.html<span class="pl-pds">'<&#47;span><&#47;span>);<&#47;span><br />
<span class="pl-s1"><span class="pl-c">&#47;&#47; .. or pass a cover as html<&#47;span><&#47;span><br />
<span class="pl-s1"><span class="pl-smi">$snappy<&#47;span><span class="pl-k">-><&#47;span>setOption(<span class="pl-s"><span class="pl-pds">'<&#47;span>cover<span class="pl-pds">'<&#47;span><&#47;span>, <span class="pl-s"><span class="pl-pds">'<&#47;span><br />
<h1>Bill cover<&#47;h1><span class="pl-pds">'<&#47;span><&#47;span>);<&#47;span><br />
<span class="pl-s1"><span class="pl-smi">$snappy<&#47;span><span class="pl-k">-><&#47;span>setOption(<span class="pl-s"><span class="pl-pds">'<&#47;span>toc<span class="pl-pds">'<&#47;span><&#47;span>, <span class="pl-c1">true<&#47;span>);<&#47;span><br />
<span class="pl-s1"><span class="pl-smi">$snappy<&#47;span><span class="pl-k">-><&#47;span>setOption(<span class="pl-s"><span class="pl-pds">'<&#47;span>cache-dir<span class="pl-pds">'<&#47;span><&#47;span>, <span class="pl-s"><span class="pl-pds">'<&#47;span>&#47;path&#47;to&#47;cache&#47;dir<span class="pl-pds">'<&#47;span><&#47;span>)<code>;<&#47;code><&#47;span><&#47;pre><br />
<&#47;div></p>
